---
phase: 04-personality-streaming
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/trading/entertainment-mode.ts
  - src/trading/types.ts
  - src/trading/index.ts
autonomous: true

must_haves:
  truths:
    - "Agent trades 3-5 times per hour when entertainment mode is enabled"
    - "Position sizes are micro (0.01-0.05 SOL) to allow frequent trading"
    - "Risk thresholds relax over time if no trade happens (time pressure)"
    - "Random degen moments can trigger trades with minimal analysis"
  artifacts:
    - path: "src/trading/entertainment-mode.ts"
      provides: "EntertainmentMode class with relaxed trading logic"
      exports: ["EntertainmentMode", "EntertainmentConfig", "EntertainmentDecision"]
    - path: "src/trading/types.ts"
      provides: "Updated RiskProfile type with ENTERTAINMENT mode"
      contains: "ENTERTAINMENT"
  key_links:
    - from: "src/trading/entertainment-mode.ts"
      to: "src/personality/mood-system.ts"
      via: "MoodSystem import for mood-based decisions"
      pattern: "import.*MoodSystem"
---

<objective>
Create Entertainment Mode for the Trading Engine - a separate decision layer that prioritizes activity over pure profit.

Purpose: The current agent is too conservative and rarely trades. Entertainment Mode makes the agent a "degen gambler" that takes risks, trades frequently (3-5/hour), and uses micro bets (0.01-0.05 SOL) so losses don't hurt. Time pressure builds if no trade happens in 5-10 minutes.

Output: EntertainmentMode class that can be used by TradingEngine to make more aggressive trade decisions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-personality-streaming/04-CONTEXT.md
@.planning/phases/04-personality-streaming/04-01-SUMMARY.md
@src/trading/trading-engine.ts
@src/trading/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EntertainmentMode class</name>
  <files>src/trading/entertainment-mode.ts</files>
  <action>
Create `src/trading/entertainment-mode.ts` with a class that:

1. Has configuration for micro betting (0.01-0.05 SOL range)
2. Tracks time since last trade and calculates "time pressure" (0-1)
3. Adjusts risk threshold based on time pressure (base: 6/10, min: 4/10 when desperate)
4. Has 8% chance of "degen moment" that triggers random ape
5. Detects volume/hype signals to trade on momentum
6. Enforces cooldowns (5 min between trades, 6 trades/hour max)
7. Integrates with MoodSystem for mood-based adjustments

Key methods:
- `evaluate(context: TokenContext): EntertainmentDecision` - main decision method
- `calculateTimePressure(): number` - returns 0-1 based on quiet period
- `checkDegenMoment(): boolean` - 8% random chance
- `getStats()` - returns current state for debugging

The class should import MoodSystem but handle it being optional (undefined).
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>EntertainmentMode class exists with time pressure, degen moments, and micro betting</done>
</task>

<task type="auto">
  <name>Task 2: Add ENTERTAINMENT to RiskProfile type</name>
  <files>src/trading/types.ts</files>
  <action>
Update the RiskProfile type definition in `src/trading/types.ts` to add ENTERTAINMENT:

Change:
```typescript
export type RiskProfile = 'CONSERVATIVE' | 'BALANCED' | 'AGGRESSIVE';
```

To:
```typescript
export type RiskProfile = 'CONSERVATIVE' | 'BALANCED' | 'AGGRESSIVE' | 'ENTERTAINMENT';
```

This allows the TradingEngine to recognize entertainment mode as a valid risk profile.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>ENTERTAINMENT is a valid RiskProfile option</done>
</task>

<task type="auto">
  <name>Task 3: Export EntertainmentMode from trading index</name>
  <files>src/trading/index.ts</files>
  <action>
Add exports for EntertainmentMode in `src/trading/index.ts`:

Add these lines:
```typescript
export { EntertainmentMode, DEFAULT_ENTERTAINMENT_CONFIG } from './entertainment-mode.js';
export type { EntertainmentConfig, EntertainmentDecision, TokenContext } from './entertainment-mode.js';
```
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>EntertainmentMode is exported from trading module</done>
</task>

</tasks>

<verification>
1. Run `npx tsc --noEmit` to verify all TypeScript compiles
2. Check EntertainmentMode can be imported from trading module
3. Verify ENTERTAINMENT is in RiskProfile type
</verification>

<success_criteria>
- EntertainmentMode evaluates tokens with relaxed thresholds
- Time pressure builds after 5-10 minutes of no trades
- Degen moments have 8% chance to trigger random apes
- Micro positions stay in 0.01-0.05 SOL range
- Hourly limit caps at 6 trades per hour
- Mood system integration affects risk tolerance
</success_criteria>

<output>
After completion, create `.planning/phases/04-personality-streaming/04-02-SUMMARY.md`
</output>
